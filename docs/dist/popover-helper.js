!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("popover-helper",[],e):"object"==typeof exports?exports["popover-helper"]=e():t["popover-helper"]=e()}(self,(()=>(()=>{"use strict";var t={d:(e,o)=>{for(var i in o)t.o(o,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:o[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{getBestPosition:()=>c,getDefaultPositions:()=>d,getElement:()=>s,getPositionStyle:()=>w,getRect:()=>r,toRect:()=>n});const o=t=>("number"!=typeof t&&(t=parseFloat(t)),isNaN(t)&&(t=0),t=Math.round(t)),i=function(t,e,o){return Math.max(e,Math.min(o,t))},n=t=>t?{left:o(t.left||t.x),top:o(t.top||t.y),width:o(t.width),height:o(t.height)}:{left:0,top:0,width:0,height:0},s=t=>{return"string"==typeof t&&t?t.startsWith("#")?document.getElementById(t.slice(1)):document.querySelector(t):(e=t,Boolean(e&&9===e.nodeType)?t.body:(t=>Boolean(t&&1===t.nodeType))(t)?t:void 0);var e},r=(t,e)=>{if(!t)return n();if(o=t,Boolean(o&&o===o.window))return{left:0,top:0,width:window.innerWidth,height:window.innerHeight};var o;const i=s(t);if(!i)return n(t);const r=i.getBoundingClientRect(),p=n(r);return e||(p.left+=window.scrollX,p.top+=window.scrollY),p.width=i.offsetWidth,p.height=i.offsetHeight,p},p=(t,e,o)=>{"start"===t.align?(t.left=Math.round(o.left),t.spaceAlign=e.left+e.width-t.left-t.width):"end"===t.align?(t.left=Math.round(o.left+o.width-t.width),t.spaceAlign=t.left-e.left):t.left=Math.round(o.left+.5*o.width-.5*t.width)},h=(t,e,o)=>{"start"===t.align?(t.top=Math.round(o.top),t.spaceAlign=e.top+e.height-t.top-t.height):"end"===t.align?(t.top=Math.round(o.top+o.height-t.height),t.spaceAlign=t.top-e.top):t.top=Math.round(o.top+.5*o.height-.5*t.height)},a={bottom:(t,e,o)=>{t.space=e.top+e.height-o.top-o.height-t.height,t.top=o.top+o.height,p(t,e,o)},top:(t,e,o)=>{t.space=o.top-t.height-e.top,t.top=o.top-t.height,p(t,e,o)},right:(t,e,o)=>{t.space=e.left+e.width-o.left-o.width-t.width,t.left=o.left+o.width,h(t,e,o)},left:(t,e,o)=>{t.space=o.left-t.width-e.left,t.left=o.left-t.width,h(t,e,o)}},d=()=>Object.keys(a),l=(t,e,o)=>{const[n,s]=((t,e)=>["top","bottom"].includes(t.position)?(t.top=i(t.top,e.top,e.top+e.height-t.height),["left","width"]):(t.left=i(t.left,e.left,e.left+e.width-t.width),["top","height"]))(t,e);((t,e,o,i,n)=>{const s=t[i],r=t[n],p=e[i],h=e[n],a=o[i],d=o[n],l=a+.5*d;if(r>h){const e=.5*(r-h);return t[i]=p-e,void(t.offset=l-p+e)}const f=s-p;if(f>=0&&p+h-(s+r)>=0)return t.passed&&(t.passed+=2),"start"===t.align?void(t.offset=.5*d):"end"===t.align?void(t.offset=r-.5*d):void(t.offset=.5*r);if(t.passed&&(t.passed+=1),f<0){const e=p;return t[i]=e,void(t.offset=l-e)}const u=p+h-r;t[i]=u,t.offset=l-u})(t,e,o,n,s),t.offset=i(t.offset,0,t[s])},f=(t,e,o,i)=>{((t,e,o)=>{(0,a[t.position])(t,e,o),t.space>=0&&(t.passed+=1)})(t,e,o),l(t,e,o),((t,e)=>{if(!e)return;if(t.position===e.position)return;const o=t.left+.5*t.width,i=t.top+.5*t.height,n=e.left+.5*e.width,s=e.top+.5*e.height,r=Math.abs(o-n),p=Math.abs(i-s);t.distance=Math.round(Math.sqrt(r*r+p*p))})(t,i)},u=(()=>{let t;return e=>{clearTimeout(t),t=setTimeout((()=>{console.table(e)}),10)}})(),c=(t,e,o,i,n)=>{const s=d();let r=!1,p=!1,h=!1,a=s;i&&("string"!=typeof i&&(i=`${i}`),(i=i.split(",").map((t=>t.trim().toLowerCase())).filter((t=>t))).includes("align")&&(r=!0,p=!0),i.includes("start")&&(r=!0),i.includes("end")&&(p=!0),(i=i.filter((t=>s.includes(t)))).length&&(h=!0,a=i));const l=[];a.forEach(((t,e)=>{const i={position:t,align:"center",index:e,top:0,left:0,width:o.width,height:o.height,space:0,spaceAlign:0,offset:0,passed:0,distance:0};r||p?(r&&l.push({...i,align:"start"}),p&&l.push({...i,align:"end"})):l.push(i)}));const c=((t,e,o,i,n,s)=>{if(s){const i=o.find((t=>t.position===s.position&&t.align===s.align));if(i){if(f(i,t,e),i.passed>=3)return i;i.calculated=!0}}const r=[];return o.forEach((o=>{o.calculated||f(o,t,e,s),r.push(o)})),r.sort(((t,e)=>t.passed!==e.passed?e.passed-t.passed:i&&t.passed>=3?n&&t.position===e.position?e.spaceAlign-t.spaceAlign:t.index-e.index:t.space!==e.space?e.space-t.space:n&&t.position===e.position?e.spaceAlign-t.spaceAlign:t.index-e.index)),u(r),r[0]})(t,e,l,h,r&&p,n);return c.changed=((t,e)=>!e||t.left!==e.left||t.top!==e.top)(c,n),c},g=(t,e,o,n,s)=>{const r=(t,e)=>[t,e].join(","),p=function(t,e){const o=Math.floor(t);let i=t<o+.5?o+.5:o+1.5;return e&&(i-=1),i},h=function(t){return p(t,!0)},a=[],d=p(0),l=h(t);o=i(o,d,l);const f=p(n),u=h(e),c=r(d,f+s),g=r(o,1),$=r(d,f),w=r(l,f),m=r(o-n,f),b=r(l-s,f);return a.push(`M${c}`),a.push("V"+(u-s)),a.push(`Q${r(d,u)} ${r(d+s,u)}`),a.push("H"+(l-s)),a.push(`Q${r(l,u)} ${r(l,u-s)}`),a.push(`V${f+s}`),o<d+n+s?(a.push(`Q${w} ${b}`),a.push(`H${o+n}`),a.push(`L${g}`),o<d+n?(a.push(`L${$}`),a.push(`L${c}`)):(a.push(`L${m}`),a.push(`Q${$} ${c}`))):o>l-n-s?(o>l-n?a.push(`L${w}`):a.push(`Q${w} ${r(o+n,f)}`),a.push(`L${g}`),a.push(`L${m}`),a.push(`H${d+s}`),a.push(`Q${$} ${c}`)):(a.push(`Q${w} ${b}`),a.push(`H${o+n}`),a.push(`L${g}`),a.push(`L${m}`),a.push(`H${d+s}`),a.push(`Q${$} ${c}`)),a.join("")},$={},w=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={bgColor:"#fff",borderColor:"#ccc",borderRadius:5,arrowSize:10};Object.keys(o).forEach((t=>{if(function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(e,t)){const s=o[t],r=e[t];"string"==typeof s?"string"==typeof r&&r&&(o[t]=r):"number"==typeof(i=r)&&!isNaN(i)&&(n=i)!==Number.MAX_VALUE&&n!==Number.MIN_VALUE&&n!==Number.NEGATIVE_INFINITY&&n!==Number.POSITIVE_INFINITY&&r>=0&&(o[t]=r)}var i,n}));const i=[t.width,t.height,t.offset,o.arrowSize,o.borderRadius,o.bgColor,o.borderColor].join("-"),n=$[t.position];if(n&&i===n.key){const e=n.style;return e.changed=$.position!==t.position,$.position=t.position,e}const s=function(t,e,o,i,n,s){const r=n+s,p=s;return{bottom:()=>({d:g(e,o,i,n,s),transform:"",padding:[r,p,p,p].map((t=>`${t}px`)).join(" ")}),top:()=>({d:g(e,o,e-i,n,s),transform:`rotate(180,${.5*e},${.5*o})`,padding:[p,p,r,p].map((t=>`${t}px`)).join(" ")}),left:()=>({d:g(o,e,i,n,s),transform:`translate(${.5*(e-o)} ${.5*(o-e)}) rotate(90,${.5*o},${.5*e})`,padding:[p,r,p,p].map((t=>`${t}px`)).join(" ")}),right:()=>({d:g(o,e,o-i,n,s),transform:`translate(${.5*(e-o)} ${.5*(o-e)}) rotate(-90,${.5*o},${.5*e})`,padding:[p,p,p,r].map((t=>`${t}px`)).join(" ")})}[t]()}(t.position,t.width,t.height,t.offset,o.arrowSize,o.borderRadius),r=[`<svg viewBox="${[0,0,t.width,t.height].join(" ")}" xmlns="http://www.w3.org/2000/svg">`,`<path d="${s.d}" fill="${o.bgColor}" stroke="${o.borderColor}" transform="${s.transform}" />`,"</svg>"].join(""),p=`url("data:image/svg+xml;charset=utf8,${encodeURIComponent(r)}")`,h={background:`${p} center no-repeat`,backgroundImage:p,padding:s.padding,changed:!0};return $.position=t.position,$[t.position]={key:i,style:h},h};return e})()));